---
import Layout from '../../layouts/Layout.astro';
import "../../styles/global.css";
---

<Layout>
    <div class="mt-20 mx-auto mb-8 w-[90%] max-w-[1280px] overflow-hidden rounded-2xl bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 border border-white/10 shadow-2xl shadow-black/50 backdrop-blur-lg">
        <div class="px-6 py-3 flex justify-between items-center bg-gradient-to-r from-gray-800 to-gray-900/50 border-b border-white/10">
            <div class="flex items-center gap-3">
                <img 
                    id="frameFavicon"
                    src="https://corecathx.github.io/FNF-Hypertext-Engine/icon.ico" 
                    alt="Game Icon"
                    class="w-5 h-5 object-contain rounded-sm"
                />
                <span class="px-2 text-sm font-medium cursor-pointer">
                    FNF Hypertext Engine â€¢ 
                    <span id='windowURL' style="color:rgba(0, 183, 255, 0.479);">corecathx.github.io/FNF...</span>
                </span>
            </div>
        </div>
        
        <div class="relative" style="padding-bottom: 56.25%">
            <iframe 
                id="gameFrame"
                src="https://corecathx.github.io/FNF-Hypertext-Engine/gameplay.html?song=Deb8" 
                class="absolute top-0 left-0 w-full h-full border-none"
                allow="fullscreen"
                style="min-height: 400px;"
            ></iframe>
        </div>

        <div class="px-6 py-4 bg-gray-900/40 border-t border-white/5">
            <div class="relative">
                <select
                    id="songDropdown"
                    class="w-full pl-4 pr-10 py-2.5 rounded-lg bg-gray-800 hover:bg-gray-700/90 border border-white/10 text-gray-300 focus:outline-none focus:ring-2 focus:ring-cyan-500/50 transition-all cursor-pointer"
                >
                    <option value="Deb8">Deb8</option>
                    <option value="Mesmerizer">Mesmerizer</option>
                    <option value="Howl">FNH': Howl</option>
                    <option value="Song4">Song 4</option>
                </select>
            </div>
        </div>
    </div>
</Layout>

<style is:global>
    select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }
    select::-ms-expand { 
        display: none; 
    }
    select option { 
        background: #1f2937; 
        padding: 0.5rem;
    }
    select option:hover { 
        background: #3b82f6 !important; 
    }
</style>

<script client>
    document.addEventListener('DOMContentLoaded', () => {
        const windowURL = document.getElementById('windowURL');
        const dropdown = document.getElementById('songDropdown');
        const frame = document.getElementById('gameFrame');
        windowURL.innerText = frame.src;
        windowURL.onclick = () => {
            window.open(frame.src, '_blank');
        };
        dropdown.addEventListener('change', () => {
            const song = dropdown.value.trim();
            if (song) {
                setTimeout(() => {
                    frame.src = `https://corecathx.github.io/FNF-Hypertext-Engine/gameplay.html?song=${encodeURIComponent(song)}`;
                    windowURL.innerText = frame.src;
                }, 200);
            }
        });
    });
</script>